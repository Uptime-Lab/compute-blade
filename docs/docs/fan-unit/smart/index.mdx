
# Smart

The Smart Fan unit utilizes the [RP2040](https://www.raspberrypi.com/products/rp2040/specifications/) microcontroller featured in the [Raspberry Pi Pico 1](https://www.raspberrypi.com/documentation/microcontrollers/pico-series.html). Using the RP2040's two UART connections, a link can be established to each blade using the fan connectors.

## Hardware

### Power Delivery
The Smart Fan Unit can be powered with +5V from both Blade `Port A` or `Port B` In addition to the USB Type-C for flashing. USB Type-C with not power the fan

### LEDs

The Smart Fan Unit has 5 LEDs

| LED  | Location | Type                               |
| ---- | -------- | ---------------------------------- |
| LED1 | Yellow   | Programmable NeoPixel at index `0` |
| LED2 | Yellow   | Programmable NeoPixel at index `1` |
| LED3 | Red      | Green Programmable at `GPIO25`     |
| LED4 | Green    | Blue Power indicator for `Port A`  |
| LED5 | Green    | Blue Power indicator for `Port B`  |
<img src='/img/fan-unit/led.webp' width={'70%'}/>

### Button

A programmable button is located on on the rear of the Smart Fan Unit. It can be addressed at `GPIO12`

### Fan control

The Smart Fan Unit uses the [EMC2101](https://www.microchip.com/en-us/product/emc2101) from Microchip/SMSC a fan controller with temperature monitoring. The EMC2101 is connected over the I2C bus to the RP2040

The EMC2101 has two temperature sensors. An internal sensors on the IC(Red) located next to Port A and an external sensors(Green) located next to Port B

<img src='\img\fan-unit\temp-sensors.webp' width={'70%'} alt="Blade Fan unit connector"/>

### Additional information
<details>
  <summary>Pin Out Guides</summary>
  <h3>Smart Fan Unit</h3>
  <img src='/img/fan-unit/smart-gpio.svg' width={'70%'} alt="Smart Fan Unit blade connecter pin out"/>
  <h3>Fan Header</h3>
  <img src='/img/fan-unit/fan-header.svg' width={'70%'}/>
  <h3>J5 Debug Header</h3>
  <img src='/img/fan-unit/j5-debug.svg' width={'70%'}/>
  
</details>

<details>
  <summary>RP2040 Pin Reference Table</summary>

  Pins used by the Smart Fan Unit

  | Pins(RP2040) | Functions         |
  |:------------:|:-----------------:|
  | GPIO1        | UART0 RX          |
  | GPIO2        | UART0 TX          |
  | GPIO4        | I2C-SDA           |
  | GPIO5        | I2C-SCL           |
  | GPIO8        | UART1 TX          |
  | GPIO9        | UART1 RX          |
  | GPIO12       | Button            |
  | GPIO15       | Two NeoPixel LEDs |
  | GPIO16       | Power to Fan      |
  | GPIO25       | LED3              |
</details>
